from src.models.channels import Channel
from fastapi import FastAPI, HTTPException, Response, APIRouter
import json


router = APIRouter()
channels: dict[str, Channel] = {}

with open("src/channels.json", encoding="utf8") as file:
    channels_raw = json.load(file)
    for channel_raw in channels_raw:
        channel = Channel(**channel_raw)
        channels[channel.id] = channel


@router.get("/channels/{channel_id}", response_model=Channel)
def read_item(channel_id: str) -> Channel:
    if channel_id not in channels:
        raise HTTPException(status_code=404, detail="Channel not found")
    return channels[channel_id]